
function formatarData() {
// variavel sheet aciona a planilha com o nome "dados" depois a variavel columnN seleciona N:N e o formato é dd/MM/yyyy dia mes e ano, por fim aplica

var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("dados");
var columnN = sheet.getRange("N:N");
// Define o formato de data
var dateFormat = "dd/MM/yyyy";

// Aplica o formato de data à coluna N
columnN.setNumberFormat(dateFormat);
}



function ordenarBase() {
// na planilha ativa ordena os dados de acordo com a coluna G (no caso abaixo)

  var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("dados");
  
  // para começar na linha 2
  
  var range = sheet.getDataRange().offset(1,0,sheet.getLastRow()-1,sheet.getLastColumn());
  
  //ordem na coluna 7, lembrando que coluna 0 é a A
  
  range.sort([{column: 7, ascending: true}]);
}




function deletaColunaVazia() {
// Começando da ultima linha, verifica as primeiras linhas, se estiver vazia deleta a coluna.
  var sheet = SpreadsheetApp.getActive().getSheetByName("dados");
  var lastRow = sheet.getLastRow();
  var lastColumn = sheet.getLastColumn();
  var data = sheet.getRange(lastRow, 1, 1, lastColumn).getValues()[0];
  
  for (var i = data.length - 1; i >= 0; i--) {
    if (data[i] === '') {
      sheet.deleteColumn(i + 1);
    } else {
      break;
    }
  }
}
